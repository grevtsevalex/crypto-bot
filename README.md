# Crypto RSI Bot

Telegram-бот, который считает RSI по криптопарам (свечи с Bybit) и рассылает подписчикам сигналы при перекупленности (SHORT) или перепроданности (LONG). Настройки (таймфрейм, число свечей, пороги RSI) можно менять прямо в боте.

## Как это устроено

1. **Цикл анализа** — бот периодически получает список торговых пар с Bybit, для каждой пары запрашивает свечи, считает RSI и при выходе за пороги отправляет уведомление подписчикам.
2. **Настройки** хранятся в `config.json`; при изменении таймфрейма или числа свечей в боте цикл анализа перезапускается с новыми параметрами.
3. **Подписчики** хранятся в `subscribers.json` (путь задаётся в конфиге).

## Требования

- Go 1.24+
- Telegram-бот (токен от [@BotFather](https://t.me/BotFather))

## Установка и запуск

```bash
# Клонировать и перейти в каталог
cd crypto-bot

# Собрать
go build -o crypto-bot .

# Создать config.json (если ещё нет) и указать telegram_token
# Пример см. ниже

# Запустить
./crypto-bot
```

При первом запуске, если `config.json` отсутствует, он создаётся с значениями по умолчанию. Обязательно заполните поле `telegram_token`.

## Конфигурация

Файл `config.json` в корне проекта:

| Параметр           | Описание                          | Пример   |
|--------------------|-----------------------------------|----------|
| `timeframe`        | Интервал свечей (минуты)         | `"15"`   |
| `limit`            | Число свечей для расчёта RSI     | `100`    |
| `rsi_period`       | Период RSI                       | `14`     |
| `overbought`       | Верхний порог → сигнал SHORT     | `80`     |
| `oversold`         | Нижний порог → сигнал LONG       | `20`     |
| `telegram_token`   | Токен бота                       | строка   |
| `subscribers_file` | Путь к файлу подписчиков         | `"subscribers.json"` |

Эти же параметры (кроме токена) можно менять в боте через команду `/settings` или кнопку «Настройки».

## Команды бота

| Команда    | Действие                    |
|------------|-----------------------------|
| `/start`   | Главное меню                |
| `/settings`| Настройки (таймфрейм, пороги) |
| `/status`  | Статус подписки             |
| `/stop`    | Отписаться от сигналов      |
| `/help`    | Справка и текущие параметры |

## Структура проекта

```
crypto-bot/
├── main.go                 # Точка входа: конфиг, подписчики, цикл анализа, вызов handlers
├── config.json             # Настройки (создаётся при первом запуске)
├── subscribers.json        # Список подписчиков (chatID)
├── go.mod
├── README.md
└── internal/
    ├── config/             # Загрузка и сохранение настроек (config.json)
    ├── exchange/           # API биржи: список пар (Bybit linear), свечи (цены закрытия)
    ├── handlers/           # Обработка событий бота: команды, inline-кнопки, меню, настройки
    ├── notify/             # Рассылка уведомлений подписчикам, анти-спам по символу/типу сигнала
    └── rsi/                # Расчёт RSI по ценам закрытия
```

- **config** — чтение/запись конфига, обновление из бота.
- **exchange** — запрос списка пар и свечей к Bybit (линейные деривативы).
- **handlers** — все команды и callback'и: подписка, настройки, при смене таймфрейма/свечей запрос перезапуска цикла.
- **notify** — отправка сообщений подписчикам, учёт последнего сигнала по символу (не слать один и тот же тип повторно).
- **rsi** — формула RSI по срезу цен закрытия.

## Пример config.json

```json
{
  "timeframe": "15",
  "limit": 100,
  "rsi_period": 14,
  "overbought": 80,
  "oversold": 20,
  "telegram_token": "YOUR_BOT_TOKEN",
  "subscribers_file": "subscribers.json"
}
```

`telegram_token` не передавайте в публичные репозитории; при необходимости добавьте `config.json` в `.gitignore`.
